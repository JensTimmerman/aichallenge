{% extends "layout.html" -%}
{% set active_page = match.winner.name if match.winner else 'Draw' %}

{% block content -%}
  <div class="content">
    <h1>
      {% set winner = match.winner %}
      {% if winner %}
        <a href="{{ url_for('bot_page', user=winner.user.nickname, botname=winner.name) }}">{{ winner.name }}</a> won
      {% else %}
        Draw
      {% endif %}
    </h1>

    <p><strong>{{ match.end_time.strftime('%d/%m %H:%M') }}</strong></p>

    {% for participation in my_participations %}
      <div class="panel panel-default">
        <div class="panel-heading">Errors encountered by {{ participation.bot.name }}</div>
        <div class="panel-body">
          {% if participation.errors %}
            {% for line in participation.errors.strip().split('\n') %}
              {{ line }}<br>
            {% endfor %}
          {% endif %}
        </div>
      </div>
    {% endfor %}

    <table class="table table-striped table-hover">
      <caption>Participants</caption>
      <tr>
        <th>Bot</th>
        <th>Rank</th>
        <th>Score</th>
        <th>Owner</th>
      </tr>
      {% for bot in match.bots %}
        <tr>
          <td><a href="{{ url_for('bot_page', user=bot.user.nickname, botname=bot.name) }}">{{ bot.name }}</a></td>
          <td>{{ bot.rank }}</td>
          <td>{{ bot.score | round(1) }}</td>
          <td><a href="{{ url_for('user_page', user=bot.user.nickname) }}">{{ bot.user.nickname }}</a></td>
        </tr>
      {% endfor %}
    </table>
  </div>
{%- endblock %}
